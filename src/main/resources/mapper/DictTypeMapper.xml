<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.jjxy.researchmanagementsystem.mapper.DictTypeMapper">

    <select id="page" resultType="edu.jjxy.researchmanagementsystem.entity.DictType">
        SELECT
        id,
        type_code AS typeCode,
        type_name AS typeName,
        remark,
        status,
        sort_no AS sortNo,
        created_at AS createdAt,
        updated_at AS updatedAt
        FROM sys_dict_type
        <where>
            <if test="typeCode != null and typeCode != ''">
                AND type_code LIKE CONCAT('%', #{typeCode}, '%')
            </if>
            <if test="typeName != null and typeName != ''">
                AND type_name LIKE CONCAT('%', #{typeName}, '%')
            </if>
            <if test="status != null">
                AND status = #{status}
            </if>
        </where>
        ORDER BY sort_no ASC, id ASC
    </select>

    <select id="listAll" resultType="edu.jjxy.researchmanagementsystem.entity.DictType">
        SELECT
            id,
            type_code AS typeCode,
            type_name AS typeName,
            remark,
            status,
            sort_no AS sortNo,
            created_at AS createdAt,
            updated_at AS updatedAt
        FROM sys_dict_type
        ORDER BY sort_no ASC, id ASC
    </select>

    <select id="getById" resultType="edu.jjxy.researchmanagementsystem.entity.DictType">
        SELECT
            id,
            type_code AS typeCode,
            type_name AS typeName,
            remark,
            status,
            sort_no AS sortNo,
            created_at AS createdAt,
            updated_at AS updatedAt
        FROM sys_dict_type
        WHERE id = #{id}
    </select>

    <select id="maxSortNo" resultType="java.lang.Integer">
        SELECT COALESCE(MAX(sort_no), 0) FROM sys_dict_type
    </select>

    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO sys_dict_type(type_code, type_name, remark, status, sort_no, created_at, updated_at)
        VALUES(#{typeCode}, #{typeName}, #{remark}, #{status}, #{sortNo}, NOW(), NOW())
    </insert>

    <update id="update">
        UPDATE sys_dict_type
        SET type_code = #{typeCode},
            type_name = #{typeName},
            remark = #{remark},
            status = #{status},
            sort_no = #{sortNo},
            updated_at = NOW()
        WHERE id = #{id}
    </update>

    <delete id="deleteById">
        DELETE FROM sys_dict_type WHERE id = #{id}
    </delete>

</mapper>
